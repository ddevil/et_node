<!DOCTYPE html>
<!-- saved from url=(0054)http://twitter.github.com/bootstrap/examples/hero.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Let's Trade</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }

      .scrollspy-example {  
          height: 100px;  
          overflow: auto;  
          position: relative;  
      }
      .nlist {  
        height: 250px !important;
        overflow: scroll;
        margin-top: 2px;
      }
      .margintop{
       margin-top: 10px; 
      }
      .tdclass {
        font-size: 4px;
        color: #333333;
      }
      .error{
        width: 400px;
      }
      .acdiv {
        width: 450px;
        height: 400px;
        font-family: 'Fenix', serif;
        overflow: scroll;
      }
      * {margin: 0; padding: 0;}
       
      .acrow {
        height: 400px;
      }
      .acchart {
        width: auto;
      }
      .shd {
        text-shadow: rgba(64, 64, 64, 0.5)
      }
      li img {
        float: left;
        margin: 0 5px 0 2px;
      }
      li {
        padding: 10px;
        overflow: auto;
      }

      li:hover {
        cursor: pointer;

        background: #88bfe8; /* Old browsers */
          background: -moz-linear-gradient(45deg,  #88bfe8 0%, #70b0e0 100%); /* FF3.6+ */
          background: -webkit-gradient(linear, left bottom, right top, color-stop(0%,#88bfe8), color-stop(100%,#70b0e0)); /* Chrome,Safari4+ */
          background: -webkit-linear-gradient(45deg,  #88bfe8 0%,#70b0e0 100%); /* Chrome10+,Safari5.1+ */
          background: -o-linear-gradient(45deg,  #88bfe8 0%,#70b0e0 100%); /* Opera 11.10+ */
          background: -ms-linear-gradient(45deg,  #88bfe8 0%,#70b0e0 100%); /* IE10+ */
          background: linear-gradient(45deg,  #88bfe8 0%,#70b0e0 100%); /* W3C */
          filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#88bfe8', endColorstr='#70b0e0',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
      }
          div.portfolio {
            width: auto;
            height: auto;
            padding: 1px;
            margin: 3px;
            color: #002157;
            font-size: 14px;
            border:1px solid;
            border-radius:5px;
          }
          span.tbl {
              width: auto;
              margin: 3px;
              color: #333333;
              font-size: 12px;
          }
          .thead {
            font-size: 12px;
            font-weight:bold;
            border:1px solid;
            background-color: #0E5737;
            color: white;
          }
          
          tr{
            margin-bottom: 10px;
            font-family: 'Fenix', serif;
          }
          tr:nth-child(odd){
            background:#cdf9d3;
          }
          td{
            font-size: 12px;
            width: 400px; 
            font-family: 'Fenix', serif;
          }
          .tbh {
            font-size: 14px;
            color: black;
            font-family: 'Fenix', serif;
          }

          .trow {
            font-weight:bold;
            color: black;
            font-size: 12px;
            font-family: 'Fenix', serif;
          }

          #acctkey {
            visibility: hidden;
          }
          #headline {
            font-size: 14px;   
          }
          #provider, #datetime {
            font-size: 10px; 
          }
          #storyid{
            visibility: hidden;
            max-width: 0px;
            font-size: 1px;
          }
          #errorblk {
            visibility: hidden;
          }

      .chrome-top{
        background: green;
        padding: 3px;
        margin: 3px;
        color: #fff;
        font-size: 14px;
        border:1px;
        border-radius:5px;
      }
      .widget-c{
        width: auto;
        height: auto;
        padding: 3px;
        margin: 3px;
        color: #fff;
        font-size: 14px;
        border:1px;
        border-radius:5px;
      }
          
    </style>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="http://twitter.github.com/bootstrap/assets/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="http://twitter.github.com/bootstrap/assets/ico/apple-touch-icon-57-precomposed.png">
    <link type="text/css" href="http://127.0.0.1/~amehrotr/mobileapp/css/smoothness/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
  </head>

  <body>

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://twitter.github.com/bootstrap/examples/hero.html#">Let's Trade</a>
          <div class="nav-collapse collapse">
      
            <form class="navbar-search pull-left">
              <input type="text" class="search-query" id="ac" placeholder="Symbol Search">
            </form>
            <form class="navbar-form pull-right">
              <input class="span2" type="text" id='username' placeholder="User name">
              <input class="span2" type="password" id = 'password' placeholder="Password">
              <button type="submit" class="btn" id='signin'>Sign in</button>
            </form>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">
      <!--
      <div class="alert alert-block" id='errorblk'>
          <button type="button" class="close" data-dismiss="alert">×</button>
          <div>
          <h4>Warning!</h4>
            <div id='error'>
            Please correct error before resubmitting...
            </div>
          </div>

      </div>
    -->
      <!-- top row for chart -->
      <div class="row padding-bottom">
        <div class="span4">
          <h6>Dow Jones</h6>
          <div class="active item"><img src="http://optchart.etrade.com/graphs/100:250.DJIND.d20.t1.s1.v0.png"/></div>
        </div>
        <div class="span4">
          <h6>NASDAQ</h6>
          <div class="active item"><img src="http://optchart.etrade.com/graphs/100:250.COMP.IDX.d20.t1.s1.v0.png"/></div>
       </div>
        <div class="span4">
          <h6>S &amp; P 500</h6>
          <div class="active item"><img src="http://optchart.etrade.com/graphs/100:250.SPX.d20.t1.s1.v0.png"/></div>
        </div>
        
      </div>
    
      <!-- end of chart row-->

      <!-- account overview row -->

      <div class='row'>
        <div class='span4'>
          <div id="chart_div" style="height: 300px;"></div>
        </div>
        <div class='span4'>
          <div id="chart_div1" style="height: 300px;"></div>
        </div>
        <div class='span4'>
          <div id="chart_div2" style="height: 300px;"></div>
        </div>
      </div>

      <!-- end of account overview row -->
      
      <!-- start of account overview row -->
      <!--
      <div class="row">
        <div id='n1' class="span4">
          <div id='acchart'>
          </div>
        </div>
        <div id='n1' class="span4">
          <div id='allocationchart'>              
          </div>
        </div>
        <div id='n1' class="span4">
          <div id='overviewChart'>              
          </div>
        </div>
      </div>
      -->
      <!-- end of account overview row -->

      <!-- new account list and chart -->
      <div class='row'>
        <div id='n1' class="span5 widget-c">
          <div class='chrome-top'>
            <span>accounts</span>
            <span class='pull-right'><i class="icon-remove"></i></span>
          </div>
          <!--
          <div>
            <div>
                  <span class='htbl'><strong></strong></span>&nbsp;
                  <span class='htbl'></strong></span>&nbsp;&nbsp;&nbsp;
                  <span class='htbl'></span>&nbsp;
                  <span class='htbl'></span>&nbsp;&nbsp;&nbsp;
            </div>
          </div>
        -->
          <div class='nlist portfolio'>
            <div>
              <table id='accountstable' class='table table-striped'>
              </table>
            </div>
          </div>
        </div>

        <div id='n1' class="span6 widget-c">
          <div class='chrome-top'>
            <span>portfolio</span>
            <span class='pull-right'><i class="icon-remove"></i></span>
          </div>
          <div>
            <div>
                  <span class='htbl'>Market Value:</span>&nbsp;
                  <span class='htbl' id='mktvalue'><strong></strong></span>&nbsp;&nbsp;&nbsp;
                  <span class='htbl'>Total Gain/Loss:</span>&nbsp;
                  <span class='htbl' id='gainloss'><strong></strong></span>&nbsp;&nbsp;&nbsp;
            </div>
          </div>
          <div class='nlist portfolio'>
            <table id='portfoliotable'  class='table table-striped'></table>
          </div>
        </div>
      </div>

      <!-- end of account list and chart -->

      <div class='row'>
        
        <div id='n1' class="span6">
          <div class='chrome-top'>
            <span>news</span>
            <span class='pull-right'><i class="icon-remove"></i></span>
          </div>
          <div class='nlist portfolio'>
            <table id='portfolionews' class="table table-striped">
            </table>
          </div>
        </div>

        <div id='n1' class="span6">
          <div class='chrome-top'>
            <span>transactions</span>
            <span class='pull-right'><i class="icon-remove"></i></span>
          </div>
          <div class='nlist portfolio'>
            <table id='transactions' class="table table-striped">
            </table>
          </div>
        </div>

      </div>

      <!-- portfolio news -->
      <div class='row'>
        
        
      </div>

      <!-- end of portfolio news -->

<!-- end of test -->
      <hr>

      <footer>
        <p>© Company 2012</p>
      </footer>

      <div class="navbar navbar-inverse navbar-fixed-bottom">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand">Place Trade</a>
          <div class="nav-collapse collapse">
          <form class="navbar-form pull-left">
              <input class="span2 input-mini" type="text" placeholder="Symbol">
              <input class="span2 input-medium" type="text" placeholder="price">
              <input class="span2 input-medium" type="text" placeholder="qty">
              
              <select class="span2 input-small shadow_slect">
                <option>Market</option>
                <option>Limit</option>
                <option>Stop-Limit</option>
              </select>
              <button type="submit" class="btn">Place</button>
            </form>
          </div>
        </div>
      </div>
    </div>

    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/js/jquery.js"></script>
    <script src="./assets/js/bootstrap-transition.js"></script>
    <script src="./assets/js/bootstrap-alert.js"></script>
    <script src="./assets/js/bootstrap-modal.js"></script>
    <script src="./assets/js/bootstrap-dropdown.js"></script>
    <script src="./assets/js/bootstrap-scrollspy.js"></script>
    <script src="./assets/js/bootstrap-tab.js"></script>
    <script src="./assets/js/bootstrap-tooltip.js"></script>
    <script src="./assets/js/bootstrap-popover.js"></script>
    <script src="./assets/js/bootstrap-button.js"></script>
    <script src="./assets/js/bootstrap-collapse.js"></script>
    <script src="./assets/js/bootstrap-carousel.js"></script>
    <script src="./assets/js/bootstrap-typeahead.js"></script>
    <script src="./assets/js/bootstrap-scrollspy.js"></script>
    
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script src="http://127.0.0.1/~amehrotr/mobileapp/js/jquery-ui-1.8.23.custom.min.js"></script>
    <script src="http://127.0.0.1:8018/socket.io/lib/socket.io.js"></script>
    <script src="http://127.0.0.1/~amehrotr/demo/assets/js/highcharts.js"></script>
     <link href="./assets/css/bootstrap-responsive.css" rel="stylesheet">
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script>
  var API_HOST = 'http://127.0.0.1:8018';
  var socket = io.connect(API_HOST);
  var sw='run';
  var BASE_URL='http://127.0.0.1:8018';

  socket.on('message', function (data) {
    document.getElementById('number').innerHTML=data.server_message;
  });
     //accountallocation
  socket.on('dashboard', function (username, data) {
    console.log('dashboard event received...');
    show_chart(username);
  });
  socket.on('quote', function (username, data) {
    console.log('quote response received');
    update_quote(username);
  });
  socket.on('news', function (username, data) {
    update_news(username);
  });
  socket.on('market_movers', function (username, data) {
    update_market_movers(username);
  });
  socket.on('indices', function (username, data) {
    update_indices(username);
  });
  socket.on('accounts', function (username, data) {
    update_accounts(username);
  });
  socket.on('portfolio', function (username, data) {
    console.log('portfolio data received');
    update_portfolio(username);
  });
  socket.on('alerts', function (username, data) {
    console.log('alerts data received');
    update_alerts(username);
  });
  socket.on('alertdetail', function (username, data) {
    console.log('alerts Detail received');
    update_alerts_details(username);
  });
  socket.on('watchlists', function (username, data) {
    console.log('watchlists received');
    update_watchlists(username);
  });
  socket.on('accountchart', function (username, data) {
    console.log('chart data received');
    console.log(username);
    show_chart(username);
  });
  socket.on('accountview', function (username, data) {
    console.log('chart data received');
    console.log(username);
    show_accounts(username);
  });
  socket.on('portfolioview', function (username, data) {
    console.log('portfolio data received');
    console.log(username);
    update_portfolio(username);
  });
  socket.on('portfoliototals', function (username, data) {
    console.log('INSIDE portfoliototals data received');
    console.log(username);
    update_portfolio_totals(username);
  });
  socket.on('portfolionews', function (username, data) {
    console.log('INSIDE portfolionews data received');
    console.log(username);
    update_portfolio_news(username);
  });
  //accountallocation
  socket.on('accountallocation', function (username, data) {
    console.log('INSIDE accountallocation data received');
    console.log(username);
    console.log(data);
    update_account_allocation(data);
  });
  //accountallocationoverview
  socket.on('accountallocationoverview', function (username, data) {
    console.log('INSIDE accountallocationoverview data received');
    console.log(username);
    console.log(data);
    update_account_allocation_overview(username, data);
  });
   //accountallocation
  socket.on('transactions', function (username, data) {
    console.log('INSIDE transactions data received');
    console.log(username);
    console.log(data);
    update_transactions(data);
  });
  socket.on('info', function (username, data) {
    update_info(username);
  });
  socket.on('error', function (username, data) {
    update_error(username);
  });

  google.load("visualization", "1", {packages:["corechart"]});

  jQuery(document).ready(function($){ 

                var auto = $("#ac").autocomplete({
                    focus:true,
                    minLength: 1,
                    source: function( request, response){
                        $.ajax({
                            type: 'GET',
                            url: 'http://127.0.0.1:8018/api/lookup',
                            data: {
                                'sym':request.term,
                            },
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            data: {
                                featureClass: "P",
                                style: "full",
                                maxRows: 5,
                                'sym': request.term
                            },
                            success: function(data){
                                console.log('Success : ' + data.LookupResponse);
                                //var json = $.parseJSON(data);
                                console.log(data.LookupResponse.Data);
                                var quote = data.LookupResponse.Data;
                                var results = [];
                                for (var i in quote) {
                                    console.log("Value:" + quote[i].description + "  " 
                                        + quote[i].symbol);
                                   var itemToAdd = {
                                        value : quote[i].symbol,
                                        label : quote[i].description + "  " + quote[i].symbol
                                    };
                                    results.push(itemToAdd);
                                } 
                                return response(results);
                            },
                            
                            _renderItem: function(ul,item) {
                                console.log(item);
                                return $( "" )
                                .data("item.autocomplete",  item + ":" + item ).addClass('ac_odd');
                            },
                            error: function(message){
                              console.log('error:' + message);
                                alert(message);
                            }
                        });
                    },
                    select: function( event, ui ) {
                        getQuote(ui.item.value);
                        get_news(ui.item.value);
                    }
                });

              });

   $(function() {
    console.log('calling the chart...');
    socket.emit('accountchart', '');
    //update_portfolio('');
  });

   <!-- charts area begins -->

   function drawChart(data1, renderTo) {
            console.log('chart data:');
            console.log(data1);
            var data = google.visualization.arrayToDataTable(data1);
            var options = {
              //title: 'My Daily Activities'
            };
            var chart = new google.visualization.PieChart(renderTo);
            chart.draw(data, options);
      }

      function drawBarChart(categories, data1, renderTo) {
        var data2 = google.visualization.arrayToDataTable(data1);
        var options = {
          title: 'Account Performance',
          titleTextStyle: {color: 'blue', fontName: 'Verdana', fontSize: '24px'},
          vAxis: {title: 'Assets',  titleTextStyle: {color: 'black', fontName: 'Verdana', fontSize: '24px'}, viewWindowMode:'pretty'},
          hAxis: {title: 'Month',  titleTextStyle: {color: 'black', fontName: 'Verdana', fontSize: '24px'}}
        };
        var chart = new google.visualization.ColumnChart(renderTo);
        chart.draw(data2, options);
      }

   <!-- end of chart area -->

  function getQuote(sym){
    socket.emit('quote', {'sym':sym});
  }
  function get_news(sym){
   socket.emit('news', {'sym':sym}); 
  }

  function showChart() {
      console.log('inside showChart...');
      var message = $('#data').val();
      $('#data').val('');
      socket.emit('accountchart', message);
  }
 function update_quote(data){
    console.log('data:' + data);
    var json = $.parseJSON(data);
    var quote = json.QuoteResponse.QuoteData;
    for (var i in quote) {
    console.log("Value:" + quote[i].Product.symbol + " Quote Status:" + quote[i].quoteStatus);
    } 
    $('#imgquote1').attr('src','http://optchart.etrade.com/graphs/150:300.CSCO.d20.t1.s1.v0.png');
  }

function update_indices(data){
    console.log('data:' + data);
    var json = $.parseJSON(data);
    var quote = json.QuoteResponse.QuoteData;
    for (var i in quote) {
    console.log("Value:" + quote[i].Product.symbol + " Quote Status:" + quote[i].quoteStatus);
    } 
    
  }
function update_news(data){
    //alert("Quote Response" + data);
    //console.log('data:' + data);
    var json = $.parseJSON(data);
    var quote = json.NewsResponse.News;
    for (var i in quote) {
    console.log("headline:" + quote[i].headline);
    $('#headline').append('<tr><td id=\'tdclass\'>' + quote[i].headline + '</td></tr>')
    } 
    //<tr><td>001</td></tr>
    //$('#n1').append('<b> Quote Response'+ ':</b> ' + data + '<br>');
  }

  function update_accounts(data){
    //alert("Quote Response" + data);
    console.log('data:' + data);
    
    var json = $.parseJSON(data);
    var quote = json.AccountListResponse.Summary;
    console.log("Net Asset Value:" + quote.netAssetValue );
    var ac = json.AccountListResponse.Accounts.Account;
    for (var i in ac) {
    console.log("Account #:" + ac[i].accountId);
    } 
  }

  function update_alerts(data){
    console.log('data:' + data);
    var json = $.parseJSON(data);
    var quote = json.AlertsResponse.Alert;
    for (var i in quote) {
      console.log("Alert Subject:" + quote[i].subject);
    } 
  }
function update_alerts_details(data){
    console.log('data:' + data);
    var json = $.parseJSON(data);
    var msg = json.AlertDetailsResponse.msgText;
    console.log('Message: ' + msg)
}

function update_market_movers(data){
    //alert("Quote Response" + data);
    //console.log('data:' + data);
    var json = $.parseJSON(data);
    var quote = json.MoversResponse.Quote;
    for (var i in quote) {
    console.log("symbol:" + quote[i].symbol + " Company Name:" + quote[i].companyName + " Last Price:" + quote[i].lastPrice);
    } 
    //$('#quoteresp').append('<b> Quote Response'+ ':</b> ' + data + '<br>');
  }
  
  function update_watchlists(data){
    console.log(data);
    var json = $.parseJSON(data);
    var quote = json.WatchListsResponse.WatchList;
    for (var i in quote) {
    console.log("Watch List Name:" + quote[i].name );
    } 
  }
  function update_error(data){
    console.log('error occurred: ' + data);
    $('#error').append(data);
  }
  function update_info(data){
    console.log(data);
  }
 function verifyLogin() {
   $.ajax({
   contentType: "application/xml",
   crossDomain: true,
   type: "GET",
   url:  "http://127.0.0.1:8018/api/login",
   contentType: "application/json; charset=utf-8",
    dataType: "json",
    data: {
        'username': $('#username').val,
        'password': $('#password').val,
    },
   success: function(x){
    console.log('success');
    },
    error: function(x){
      console.log(x.statusText);
      alert(x.statusText);
      return false;

    }
   });
   //alert('success');
};

function show_window() {
    alert('show login window');
                //Getting the variable's value from a link 
    var loginBox = $(this).attr('href');

    //Fade in the Popup
    $('#login-box').fadeIn(300);
    
    //Set the center alignment padding + border see css style
    var popMargTop = ($('#login-box').height() + 24) / 2; 
    var popMargLeft = ($('#login-box').width() + 24) / 2; 
    
    $('#login-box').css({ 
      'margin-top' : -popMargTop,
      'margin-left' : -popMargLeft
    });
    
    // Add the mask to body
    $('body').append('<div id="mask"></div>');
    $('#mask').fadeIn(300);
    
    return false;
  };

  function show_accounts(data){
    console.log('printing accounts');
    console.log('array length:' + data.length);
    $('#accountstable').empty();
    for ( var i = 0; i < data.length; i++){
      var a = data[i];
        console.log("Accounts:" + a[0]);
        var acview = "<tr class='trow'><td class='tbh' colspan='3'>" + a[0] 
            + "</td></tr><tr><td><div id='" + a[4] +"'><img src='./assets/img/chart_pie.gif' alt='" + a[4] + "'></div><div id='acctkey'>" + a[4] + "</div></td>"
            + "<td><div><span><strong>Net Account Value:"
            + "</strong></span>&nbsp;&nbsp;&nbsp;<span>" + a[1].toFixed(2)
            + "</span></div><div><span><strong>Purchasing Power:</strong></span>&nbsp;&nbsp;&nbsp;<span>" + a[2].toFixed(2)
            + "</span></div><div><span><strong>Available for withdrawal:</strong></span>&nbsp;&nbsp;&nbsp;<span>" + a[3].toFixed(2)
            + "</span></div></td></tr>";
          $('#accountstable').append(acview).fadeIn(700);          
    }
  //$('#accountlistId').append(data);
  }

  function update_portfolio(data){
    var table_header = "<tr><th>Symbol</th><th>Qty</th><th>Last</th><th>Change$(%)</th><th>Price Paid</th><th>Day's Gain</th><th>Total Gain$(%)</th><th>Market Value</tr>";
    console.log(data);
    $("#portfoliotable").empty()
    $("#portfoliotable").append(table_header);
    for (var i=0; i < data.length; i++){
      var a = data[i];
      var pview = "<tr class='trow'><td>" + a[0] + "</td><td>" + a[1] 
                +"</td><td>" + a[2] 
                +"</td><td>" + a[3] 
                +"</td><td>" + a[4] 
                + "</td><td>" + a[5] 
                + "</td><td>" + a[6]
                + "</td><td>" + a[7] 
                +"</td></tr>";
   
      $("#portfoliotable").append(pview).fadeIn(700);

    }
  }
  function update_portfolio_totals(data){
    //mktvalue
    console.log('inside update_portfolio_totals...');
    console.log(data);
    var json = $.parseJSON(data);
    var netAssets = json.PortfolioSummaryResponse.netAssets;
    var totalGainLoss = json.PortfolioSummaryResponse.Totals.totalGainLoss;
    //totalGainLossPct
    var totalGainLossPct = json.PortfolioSummaryResponse.Totals.totalGainLossPct;
    console.log('netAssets:' + netAssets + ":totalGainLoss:" + totalGainLoss + ":totalGainLossPct:" + totalGainLossPct);
    $("#mktvalue").empty();
    $("#mktvalue").append((json.PortfolioSummaryResponse.netAssets).toFixed(2));
    $("#gainloss").empty();
    $("#gainloss").append(totalGainLoss.toFixed(2) + "(" + totalGainLossPct.toFixed(2) + ")" );

  }

  function update_portfolio_news(data){
    console.log('inside update_portfolio_news...');
    console.log(data);
    for (var i=0; i < data.length; i++){
      var a = data[i];
      var pn = "<tr><td><div><span class='news' id='headline'>" + a[0] + "</span>&nbsp;<span id='datetime' class='pull-right'><strong>"
              + a[1] + "</strong></span>&nbsp;<span id='storyid'>" + a[3] 
              +"</span></div><div><span id='provider' class='pull-right'><strong>" + a[2] 
              + "</strong></span>&nbsp;&nbsp;&nbsp;</div></td></tr>";
      console.log(pn);
      $("#portfolionews").append(pn);
    }
  }

  function update_transactions(data){
    console.log('inside update_transactions...');
    console.log(data);
    for (var i=0; i < data.length; i++){
      var a = data[i];
      var pn = "<tr><td><div><span class='news' id='headline'>" + a[3] + "</span>&nbsp;<span id='datetime' class='pull-right'><strong>"
              + new Date(a[1]) + "</strong></span>&nbsp;<span id='storyid'>" + a[2] 
              +"</span></div><div><span id='provider' class='pull-right'><strong>" + a[2] 
              + "</strong></span>&nbsp;&nbsp;&nbsp;</div></td></tr>";
      console.log(pn);
      $("#transactions").append(pn);
    }
  }
  function update_account_allocation(data){
    console.log('going to add the account allocation details...');
    console.log($('table tbody tr  td div img'));
    console.log(data[0]);
    $('table tbody tr  td div').each(function(index) {
      console.log('Div value:' + $(this).attr("id"))
      //console.log(index + ': ' + $(this).attr("id"));
      if(data[0] == $(this).attr("id") ){
        console.log(' got the match..going to put the chart now...');
        console.log(data[1]);
        //showChart(data[1], allocationchart );
        drawChart(data[1], document.getElementById('chart_div'));
      }
    });
  }
  function update_account_allocation_overview(username, data){
    //show_overview_chart(username, data);
    drawBarChart(username, data, document.getElementById('chart_div1'));
  }
  function show_chart(data){
    console.log('show chart data received');
    console.log(data);
    //showChart(data);
    drawChart(data, document.getElementById('chart_div2'))
  }

  function show_overview_chart(categories, data){
    var chart1;
    chart1 = new Highcharts.Chart({
            chart: {
                renderTo: 'overviewChart',
                type: 'column',
                margin: [ 50, 50, 100, 80]
            },
            title: {
                text: 'Account\'s Overview'
            },
            xAxis: {
                categories: categories,
                labels: {
                    rotation: -45,
                    align: 'right',
                    style: {
                        fontSize: '10px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Assets'
                }
            },
            legend: {
                enabled: false
            },
            tooltip: {
                formatter: function() {
                    return '<b>'+ this.x +'</b><br/>'+
                        'Assets: '+ Highcharts.numberFormat(this.y, 1) +
                        '';
                }
            },
                series: [{
                name: 'Assets',
                data: data,
                dataLabels: {
                    enabled: true,
                    rotation: -90,
                    color: '#FFFFFF',
                    align: 'center',
                    x: -3,
                    y: 10,
                    formatter: function() {
                        return this.y;
                    },
                    style: {
                        fontSize: '12px',
                        fontFamily: 'Verdana, sans-serif'
                    }
                }
            }]
        });
  }





  function showChart(accountdata, renderLoc){
    var chart2;
    if (renderLoc == null)
      renderLoc = 'acchart';
    Highcharts.getOptions().colors = $.map(Highcharts.getOptions().colors, function(color) {
        return {
            radialGradient: { cx: 0.5, cy: 0.3, r: 0.7 },
            stops: [
                [0, color],
                [1, Highcharts.Color(color).brighten(-0.3).get('rgb')] // darken
            ]
        };
    });
    chart2 = new Highcharts.Chart({
            chart: {
                renderTo: renderLoc,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            title: {
                text: 'Accounts Allocation'
            },
            tooltip: {
              pointFormat: '{series.name}: <b>{point.percentage}%</b>',
              percentageDecimals: 1
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        color: '#000000',
                        connectorColor: '#000000',
                        
                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ this.percentage.toFixed(2) +' %';
                        }
                    },
                    showInLegend: true
                }
            },
            series: [{
                type: 'pie',
                name: 'Account Allocation',
                point: {
                  events: {
                        click: function(event) {
                          this.slice();
                          var clicked = this;
                          alert(clicked.config[0]);
                        }
                    }
                },
                data: accountdata
            }]
        });
}
  $(function(){
    $('#signin').click( function() {
      //verifyLogin();
      /*
        //alert('sign in...'); 
        var message = $('#data').val();
        $('#data').val('');
        console.log('signin clicked going to write on socket...');
        //alert('username:' + $('#username').val() + $('#password').val());

        $.ajax({
            type: 'GET',
            url: 'http://127.0.0.1:8018/api/login',
            data: {
              'username':$('#username').val(),
              'password': $('#password').val()
            },
            contentType: "application/xml; charset=utf-8",
            dataType: "xml",
            success: function(data){
                console.log('Success : ' + data.LookupResponse);
                return response(results);
            },
            error: function(message){
              console.log('error:' + message);
                alert(message);
            }
          });
        //socket.emit('login', {'username':$('#username').val(), 'password':$('#password').val()});
        */
        return true;
    });

    $('#quotereq').click( function() {
        var message = $('#data').val();
        $('#data').val('');
        console.log('going to write on socket...');
        // tell server to execute 'sendchat' and send along one parameter
        socket.emit('quote', message);
    });
    $('#newsreq').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('news', message);
    });
    $('#market_movers').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('market_movers', message);
    });
    $('#indices').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('indices', message);
    });
    $('#accounts').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('accounts', message);
    });
    $('#portfolio').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('portfolio', message);
    });
    $('#alerts').click( function() {
      var message = $('#data').val();
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('alerts', message);
    });
  
    $('#alertdetail').click( function() {
      var alertId = '268547'
      $('#data').val('');
      console.log('going to write on socket...');
      // tell server to execute 'sendchat' and send along one parameter
      socket.emit('alertdetail', {'id':alertId});
    });
    $('#watchlists').click( function() {
      console.log('going to write on socket...');
      socket.emit('watchlists', '');
    });
    $('#accountlistId li div').live('click', function(){
      console.log('going to call portfolio api...');
      var accountIdKey = $(this).attr("id");
      if(accountIdKey == null || accountIdKey == undefined)
        return;
      console.log($(this).attr("id"));
      socket.emit('portfolio', {'accountIdKey': $(this).attr("id")});
      //alert('Hii');
    });

    $('table tbody tr  td div img').live('click', function(){
      console.log('going to call portfolio api...');
      console.log($(this).attr("alt"));
      socket.emit('portfolio', {'accountIdKey': $(this).attr("alt")});
      //alert('Hii');
    });

    // portfolio news
    /*
    $('table tbody tr  td').live('click', function(){
      console.log('going to call portfolio news api...');
      console.log($("#portfolionews tbody tr td div span"));
      console.log($(this).attr("storyid"));
      //socket.emit('portfolio', {'accountIdKey': $(this).attr("alt")});
      //alert('Hii');
    });
*/

    $('#headline').live('click', function(){
      console.log('going to call portfolio news api...');
      console.log($(this).siblings("#storyid").text());
      $('#about-wrapper').hide().fadeTo(0, 0);
      $('#transparent-overlay').fadeTo(200, 0, function(){
        $(this).hide();
      });
      //socket.emit('portfolio', {'accountIdKey': $(this).attr("alt")});
      //alert('Hii');
    });
});

</script>

  

</body></html>